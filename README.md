# 域名跟踪工具

一个用于跟踪网站 18+ 4色网 (`https://www.k8w4w.com`) 最新域名的Python工具，支持自动域名管理、系统托盘功能和图形界面。

## 功能特性

### 🎯 核心功能
- **自动域名管理**：自动记录并维护最近10个有效域名
- **智能访问策略**：优先尝试最近使用的域名，失效时按时间顺序尝试其他域名
- **自动清理**：自动移除无法跳转至新域名的无效地址
- **手动更新支持**：全部域名失效时提示用户手动更新

### 🖥️ 用户界面
- **主界面GUI**：显示完整的域名历史记录和实时状态
- **系统托盘**：支持最小化到系统托盘，鼠标悬停显示当前域名
- **一键复制**：点击托盘图标自动复制最新域名到剪贴板
- **状态监控**：实时显示当前检测状态和域名健康度

### 🛡️ 可靠性保障
- **异常处理**：完善的异常处理和错误恢复机制
- **网络超时**：所有网络请求设置合理超时时间
- **重定向处理**：自动识别并处理重定向逻辑
- **健康检查**：定期检查系统组件健康状态

## 系统要求

- **操作系统**：Windows 7/8/10/11
- **Python版本**：Python 3.7+
- **网络连接**：需要互联网连接进行域名检查

## 安装说明

### 1. 克隆或下载项目
```bash
git clone <repository-url>
cd url
```

### 2. 安装依赖
```bash
pip install -r requirements.txt
```

### 3. 运行程序
```bash
python main.py
```

## 使用指南

### 首次启动
1. 运行 `python main.py` 启动程序
2. 程序会自动创建必要的配置文件和数据目录
3. 主界面会显示当前的域名列表（初始为空）
4. 程序会自动最小化到系统托盘

### 添加域名
1. 在主界面点击「添加域名」按钮
2. 输入要跟踪的域名（支持 http:// 或 https:// 前缀）
3. 程序会自动验证域名的可访问性
4. 验证成功后域名会被添加到列表中

### 系统托盘功能
- **鼠标悬停**：显示当前最新有效域名
- **左键点击**：复制当前域名到剪贴板
- **右键菜单**：
  - 打开主界面
  - 复制当前域名
  - 检查域名状态
  - 退出程序

### 主界面功能
- **域名列表**：显示所有域名的状态、添加时间、最后检查时间等信息
- **状态指示**：
  - ✓ 可用：域名正常访问
  - ✗ 不可用：域名无法访问
  - ⚠ 错误：域名检查时出现错误
  - ? 未知：域名状态未知
- **操作按钮**：
  - 添加域名：手动添加新域名
  - 检查所有域名：批量检查所有域名状态
  - 复制当前域名：复制最新可用域名
  - 清理无效域名：移除长期无效的域名
  - 导出/导入域名：备份和恢复域名列表
  - 域名统计：查看域名状态统计信息

### 右键菜单（域名列表）
- **复制域名**：复制选中的域名
- **在浏览器中打开**：使用默认浏览器打开域名
- **检查此域名**：单独检查选中域名的状态
- **删除域名**：从列表中删除选中的域名

## 配置说明

程序的配置文件为 `config.py`，主要配置项包括：

### 基础配置
- `MAX_DOMAINS`：最大保存域名数量（默认：10）
- `CHECK_INTERVAL`：域名检查间隔（默认：300秒）
- `REQUEST_TIMEOUT`：网络请求超时时间（默认：10秒）

### 文件路径
- `DATA_DIR`：数据存储目录
- `DOMAINS_FILE`：域名数据文件
- `LOG_FILE`：日志文件路径

### 网络配置
- `MAX_RETRIES`：最大重试次数
- `RETRY_DELAY`：重试延迟时间
- `USER_AGENT`：HTTP请求用户代理

## 数据文件

### 域名数据文件 (domains.json)
存储所有域名信息，包括：
- URL地址
- 添加时间
- 最后检查时间
- 状态信息
- 检查次数
- 错误次数

### 日志文件 (domain_tracker.log)
记录程序运行日志，包括：
- 域名检查结果
- 错误信息
- 系统状态
- 用户操作

## 故障排除

### 常见问题

**Q: 程序启动后没有显示主界面**
A: 程序默认会最小化到系统托盘，请检查系统托盘区域的图标。

**Q: 域名检查总是失败**
A: 请检查网络连接，确保可以正常访问互联网。也可能是目标域名确实无法访问。

**Q: 系统托盘图标不显示**
A: 请确保系统托盘功能已启用，某些系统可能需要手动启用托盘图标显示。

**Q: 程序占用内存过高**
A: 可以尝试清理无效域名，或者重启程序。程序会自动进行内存管理。

### 日志查看
如果遇到问题，可以查看日志文件 `logs/domain_tracker.log` 获取详细的错误信息。

### 重置程序
如果程序出现严重问题，可以删除以下文件来重置程序：
- `data/domains.json`：域名数据
- `logs/domain_tracker.log`：日志文件

## 开发说明

### 项目结构
```
url/
├── main.py                 # 主程序入口
├── config.py              # 配置文件
├── logger.py              # 日志管理
├── domain_manager.py      # 域名管理模块
├── network_checker.py     # 网络检查模块
├── tray_manager.py        # 系统托盘模块
├── gui_manager.py         # GUI界面模块
├── exception_handler.py   # 异常处理模块
├── requirements.txt       # 依赖包列表
├── README.md             # 说明文档
├── data/                 # 数据目录
│   └── domains.json      # 域名数据文件
└── logs/                 # 日志目录
    └── domain_tracker.log # 日志文件
```

### 核心模块说明

- **main.py**：程序主入口，负责初始化各个组件和异常处理
- **domain_manager.py**：域名管理核心，处理域名的增删改查和状态管理
- **network_checker.py**：网络检查模块，负责域名可访问性检查和重定向处理
- **gui_manager.py**：图形界面模块，提供主窗口和各种对话框
- **tray_manager.py**：系统托盘模块，处理托盘图标和菜单
- **exception_handler.py**：异常处理模块，提供全面的错误处理和恢复机制

### 扩展开发
如果需要扩展功能，建议：
1. 遵循现有的模块化设计
2. 使用统一的异常处理机制
3. 添加适当的日志记录
4. 更新配置文件和文档

## 许可证

本项目采用 MIT 许可证，详情请参见 LICENSE 文件。

## 更新日志

### v1.0.0 (2024-01-XX)
- 初始版本发布
- 实现基础域名跟踪功能
- 支持系统托盘和GUI界面
- 完善的异常处理机制
- 自动域名管理和清理功能

## 技术支持

如果在使用过程中遇到问题，请：
1. 查看本文档的故障排除部分
2. 检查日志文件获取详细错误信息
3. 提交 Issue 描述问题和错误日志

---

**注意**：本工具仅用于合法的域名跟踪用途，请遵守相关法律法规和网站使用条款。
